# 리액트 안티패턴 소개
- 해당 챕터에서 다루는 내용
```md
- UI 구축의 어려움에 대한 이해
- 상태 관리의 이해
- 예외 흐름 살펴보기
- 리액트의 일반적인 안티패턴 살펴보기
```

## 상태 관리의 이해
- 서버에서 받아오는 데이터를 서버 상태라고 한다.
- 서버 상태를 다루기 위해 몇가지 주의해야 하는 사항들이 존재한다.
```md
- 비동기 특성: 여러 원격 데이터를 동기화할 때 시간의 순서가 중요하다.
- 오류 처리: 원격 소스 연결은 때로는 실패하거나, 서버에서 오류를 응답할 수 있다.
- 로딩 상태: 로딩 중 상태를 효과적으로 다뤄야 한다. 일반적으로 로딩 표시기 또는 fallback UI를 제공한다.
- 일관성: 여러 사용자가 동일한 데이터를 변경하는 애플리케이션은 다루기 어렵다.
- 캐싱: 캐싱이 성능이 좋을 수도 있지만, 자칫 데이터 일관성을 해치거나 일관성 유지를 보장하기 위한 복잡한 코드가 들어갈 수 있다.
- 업데이트 및 낙관적 UI: 서버 응답이 오래 걸리는 경우를 위해 미리 UI를 업데이트 하는 방식은 유용하나, 서버에서 에러를 발생시켰을 때 revert 할 수 있는 방법이 필요하다.
```
- 동적인 데이터 목록을 렌더링할 때 index를 key로 사용하면, 데이터의 순서가 변경되거나 항목이 삭제되었을 때 React가 기존 index의 DOM을 그대로 재사용한다.
이로 인해 input 상태, 애니메이션 효과, focus 상태 등 이전 항목의 DOM 속성이 새 항목에 잘못 적용될 수 있어, 예기치 못한 버그가 발생할 수 있다.
- 어플리케이션에서 보여주는 데이터는 일부라도 아코디언 같은 컴포넌트의 expand 상태를 관리하거나 기타 등등 배보다 배꼽이 커지는 상태관리가 코드가 만들어지는 경우가 있다.
- 이를 위해 Redux를 예시로 들었지만, 보통은 Context API를 사용한 상태관리를 더 선호한다고 한다. -> Context API도 성능 이슈 때문에 제거하려고 하는데 맞는건지 모르겠다.

## 예외 흐름 탐색하기
### 다른 컴포넌트에서 발생한 오류
- 서드파티 컴포넌트를 사용하거나, api 응답 값이 undefined 혹은 null일 때 처리가 되지 않으면 전체 애플리케이션이 멈춘다.
- 에러바운더리로 에러를 격리시키면 위의 문제는 해결이 가능하다.
### 예측하지 못한 사용자 행동
- Input 필드에 애플리케이션이 의도하는 입력 값만 들어갈 수 있도록 제한하는 방식이 있다는 예시를 들고 있다.
- 현재 회사에서의 사례로는, Input 필드에 숫자를 입력해야 하는 경우가 많이 있는데, 숫자만 입력하도록 제한을 둠과 동시에 max나 min 값을 벗어난 숫자를 입력하고 제출하면 제출이 안되도록 막고 Input 필드 하단에 errorText를 보여준다.

## 리액트의 일반적인 안티패턴 살펴보기
### Props Drilling
- props drilling으로 인해 유지보수가 떨어지므로 contextApi를 활용한다.
### 컴포넌트 내 데이터 변환
- 백엔드에서 받은 데이터를 변환하는 작업을 컴포넌트 내에서 수행하는 것은 안티패턴이다.
  - 명확하지 않음: 데이터 가져오기와 변환, 렌더링 작업이 하나의 컴포넌트 안에서 이루어지므로 이 컴포넌트가 어떤 역할을 하는지 알기 어렵다.
  - 재사용성이 떨어짐: 다른 컴포넌트에서 유사한 변환이 필요한 경우, 로직의 중복이 발생한다.
  - 테스트하기 어려움: 테스트를 하려면 변환 로직을 고려해야 하므로 테스트 코드가 더 복잡해집니다.
  ```md
   이 방식은 현재 회사에서 많이 쓰고 있었는데 반성할 필요가 있다....
  ```
### 뷰 영역의 복잡한 로직
- 비즈니스 로직과 프레젠테이션 계층을 분리해야 하면 모듈화되고 관리하기 쉬운 코드베이스를 구축할 수 있다.

### 테스트 부족
- TDD는 테스트 코드를 먼저 작성하고, 실제 컴포넌트 로직을 나중에 작성하는 것을 권장한다.
- TDD는 오류를 조기에 발견하는 것에 그치지 않고 잘 구조화되고 유지보수 가능한 코드 작성을 가능하게 한다.

### 안티패턴을 없애기 위한 접근 방식
- 인터페이스 지향 프로그래밍
  - 인터페이스를 통해 소프트웨어 모듈 간에 발생하는 상호작용을 중심으로 소프트웨어를 구성하는 데 중점을 둔다.
- 헤드리스 컴포넌트 패러다임
  - 직접적인 렌더링 역할은 없지만 상태 또는 로직을 관리하는 컴포넌트를 구현한다.
