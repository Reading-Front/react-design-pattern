# 7장 리액트에서의 테스트 주도 개발

## TDD 이해하기

### TDD 사이클

TDD의 핵심에는 레드-그린-리팩터 루프(Red-Green-Refactor) loop라 불리는 사이클이 있습니다.

TDD를 실천할 때 필수적인 3단계 절차가 있습니다.

- 레드: 이 단계에서는 새로운 기능 또는 기능의 수정 사항을 확인하기 위한 테스트를 작성합니다. 아직 기능 구현이 되지 않은 상태에서 작성하기 때문에 초기에는 테스트가 실패할 수밖에 없습니다. Jest와 같은 대부분의 테스트 프레임워크에서는 붉은색 텍스트로 실패를 표시합니다.
- 그린 : 이 단계에서는 테스트를 통과시키기 위한 최소한의 코드를 작성합니다. 되도록 적은 코드를 작성하여 테스트를 통과하고, 텍스트를 녹색으로 바꾸는 것으로 충분합니다.
- 리팩터 : 마지막으로 기능 동작을 유지하면서 코드를 정리합니다. 리팩터 단계에서는 기능을 그대로 유지하면서 코드의 효율성과 가독성을 높이는 작업을 진행합니다. 리팩터링이 완료된 후에도 테스트는 통과해야만 합니다.

### TDD 장점

- 특정 기능에 대한 테스트를 먼저 작성함으로써 한 번에 하나의 문제에만 집중적으로 집중할 수 있습니다.
- 다음 단계를 예측할 수 있으므로 인지 부하를 줄여 직면한 작업 자체에 집중할 수 있게 합니다.
- 테스트를 통과하는 데 필요한 가장 단순한 코드를 작성하게 하여, 최소한의 설계를 구성하므로 이해하고 유지보수하기 쉽습니다.
- 코딩에 대한 구조화된 접근 방식으로 사고의 흐름을 유지하게 합니다.
- 탄탄한 테스트 커버리지를 이미 가지고 있음을 보장합니다. 테스트를 작업 이후에 추가하는 게 아니라 개발 과정에 포함하여 보다 안정적인 코드베이스를 만듭니다.

### 여러 종류의 TDD

- 기본 TDD:
  단위 테스트에 집중합니다. 개별 함수나 메서드와 같은 가장 작은 단위의 코드에 대해 테스트를 작성합니다.
  로직과 알고리즘을 테스트하기에는 좋지만, 리액트처럼 복잡한 UI 프레임워크에서는 여러 부분이 어떻게 상호작용을 하며 동작하는지 찾아내기가 어렵습니다.
- ATDD(Acceptance Test Driven Development) :
  사용자 승인 테스트로 개발 과정을 시작하는 것을 추가하여 TDD를 확장한 것입니다. 어떤 코드를 작성하기 전에 이해관계자들과 협업하여 사용자 관점에서 완료 상태를 정의합니다.
- BDD(Behavior-Driven-Development)
  TDD와 ATDD 이후에 나온 방법론으로, 애플리케이션에 주어지는 입력에 대한 반응에 주목합니다. 특정 메서드가 기대하는 결괏값을 반환하는지 체크하는 테스트를 작성하기보다 BDD 테스트는 시스템이 특정 조건에서 예상한 대로 동작하는지를 확인합니다. BDD는 테스트를 정의하는 데 보다 서술적인 언어를 사용하여 이해관계자 중 비개발자도 쉽게 이해할 수 있게 합니다.
  - Cucumber라는 도구를 사용하여 일반인이 읽을 수 있는 형태로 상세한 스펙에 대해 정의하며, Gherkin이라고 부르는 자연어와 유사한 형태의 테스트를 사용합니다.

## 태스킹 이해하기

태스킹(Tasking)은 TDD 과정에서 필요한 단계로, 사용자 스토리 또는 기능을 작고 다루기 편한 태스크로 나누어 테스트 케이스의 기본 단위로 활용합니다. 태스킹의 목적은 코드로 무엇을 작성할지, 어떻게 테스트할지, 어떤 순서로 진행할지를 분명히 결정하는 데 있습니다.

큰 요구사항을 작은 단위로 쪼개면 여러 가지 장점이 있습니다.

- 범위가 명확해지므로 무엇을 완료해야 하는지, 어떤 방법으로 접근할지 이해하기 쉬워집니다.
- 복잡한 문제를 작은 태스크로 나누어 다루기 용이합니다.
- 태스트가 나뉘면 중요도와 논리적 구축에 따라 작업의 우선순위를 정할 수 있습니다.
- 작성하는 테스트가 명확하고 즉각적인 목적을 수행하도록 보장하여 TDD 사이클을 보다 효율적으로 만들어줍니다. 개별 작업에 집중할 수 있습니다.
- 팀원들이 개별 테스크를 맡아 작업할 수 있습니다. 모든 작업이 큰 단위 기능으로 결합되어 기여한다는 점을 알고 작업을 진행할 수 있으므로 협업이 증대됩니다.

### 태스킹 과정

(1) 사용자 스토리를 검토하거나 구현해야 할 기능에 대해 이해합니다.

요구사항을 세분화 하는 데 일반적으로 상향식(bottom-up)과 하향식(top-down)의 2가지 방식으로 나누어 볼 수 있습니다.

- 상향식 TDD는 작고 기초적인 기능들의 테스트 코드를 작성하고 기능을 구현하는 것부터 시작합니다. 각각의 작업마다 개별 컴포넌트에 집중하며, 컴포넌트들은 최소한의 기능에서 시작하여, 점점 세부 기능들이 추가됩니다. 테스트 케이스도 마찬가지로 기능 요구사항에 따라 늘려 나가면서 엣지 케이스들도 추가합니다.
- 하향식 TDD는 시스템의 전체 구조와 기능부터 시작합니다. 메인 컴포넌트의 기능을 구현하느 것부터 시작하여 이후 세부적인 기능들로 점진적으로 확장해 나갑니다. 이 방식은 시스템의 주된 목적과 작업의 흐름을 초반부터 확립할 수 있고, 명확한 개발 로드맵을 알 수 있습니다. 전체 목표에 더 잘 맞는 방식으로 통합을 유도할 수 있지만, 개발되기 전인 하위 단계 컴포넌트의 동작을 파악하기 위해 임시로 스텁이나 모킹이 필요할 수 있습니다.

(2) 스토리를 도메인 개념, 비즈니스 규칙, 사용자 작업의 단위와 같은 로직의 단위로 나눕니다.

(3) 태스트 목록을 작성합니다. 태스크는 충분히 작은 단위여야 합니다.

(4) 태스크를 완수하기 위한 가장 논리적인 순서로 나열합니다. 모든 것이 오류 없이 동작하는 기본 시나리오를 기반으로 시작하고, 이후에 예외 케이스를 다룬 다음 오류를 처리하는 순서로 진행합니다.

(5) 각각의 태스크 기능을 보장해주는 테스트 케이스를 식별합니다. 테스트 코드를 작성하는 것이 아니라 어떤 것들을 테스트할지를 파악하면 충분합니다.
